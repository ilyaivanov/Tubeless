(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(16),o=n.n(a),c=(n(66),n(7)),u=n(18),d=n(49),l=n.n(d),s=n(2),f=n(3);function p(){var e=Object(s.a)(["\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-top: 2px;\n  padding-bottom: 2px;\n  padding-left: ","px;\n"]);return p=function(){return e},e}var m=f.a.div(p(),function(e){return 20*e.level});function v(){var e=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return v=function(){return e},e}var h=f.a.div(v());function g(){var e=Object(s.a)(["\n  height: ","px;\n  width: ","px;\n  min-width: ","px;\n"]);return g=function(){return e},e}function b(){var e=Object(s.a)(["\n  width: 0;\n  height: 0;\n  border-style: solid;\n  ",";\n  visibility: hidden;\n  ",":hover & {\n    visibility: visible;\n  }\n"]);return b=function(){return e},e}var y=function(e){return i.a.createElement(E,{onClick:e.onClick},i.a.createElement(O,{"data-testid":"arrow-"+e.nodeId,orientation:e.orientation}))},O=f.a.div(b(),function(e){return j(e.orientation)},m),E=Object(f.a)(h)(g(),15,15,15),j=function(e){var t=6.9282.toFixed(1);return"right"===e?"\n    border-width: ".concat(4,"px 0 ").concat(4,"px ").concat(t,"px;\n    border-color: transparent transparent transparent ").concat("rgb(75, 81, 85)",";\n  "):"  \n    border-width: ".concat(t,"px ").concat(4,"px 0 ").concat(4,"px;\n    border-color: ").concat("rgb(75, 81, 85)"," transparent transparent transparent;\n    ")};function x(){var e=Object(s.a)(["\n  height: 2px;\n  background-color: grey;\n  position: absolute;\n  left: ","px;\n  right: 0;\n  ",";\n"]);return x=function(){return e},e}var w=f.a.div(x(),function(e){return 15+20*e.placement.dragLevel},function(e){return"AFTER"===e.placement.orientation?"bottom: -1px":"top: -1px"}),I=n(52),C=n.n(I),k=n(53),D=n.n(k),R=n(54),S=n.n(R),A=n(55),B=n.n(A);function P(){var e=Object(s.a)(["\n  margin-right: 5px;\n"]);return P=function(){return e},e}function T(){var e=Object(s.a)(["\n  filter: invert(0.3);\n  ",":hover & {\n    filter: invert(0);\n  }\n"]);return T=function(){return e},e}var F=i.a.forwardRef(function(e,t){var n=e.node;return i.a.createElement(N,{ref:t,"data-testid":"drag-handle-"+n.id},i.a.createElement(V,{src:L(n),alt:"",width:25,height:25}))}),L=function(e){if(e.isHidden)return C.a;var t=e.children;return t?t.length>1?D.a:S.a:B.a},V=f.a.img(T(),m),N=f.a.div(P());function H(){var e=Object(s.a)([""]);return H=function(){return e},e}var U=f.a.span(H());function M(){var e=Object(s.a)(["\n  visibility: hidden;\n  ",":hover & {\n    visibility: visible;\n  }\n  padding-left: 10px;\n"]);return M=function(){return e},e}var z=function(e){var t=e.onEdit,n=e.onDelete,r=e.nodeId;return i.a.createElement(K,null,i.a.createElement("button",{"data-testid":"edit-"+r,onClick:t},"E"),i.a.createElement("button",{"data-testid":"delete-"+r,onClick:n},"X"))},K=f.a.div(M(),m);function W(){var e=Object(s.a)(["\n  height: 32px;\n  width: 32px;\n\n  max-width: 100%;\n\n  border-radius: ","px;\n\n  ",";\n  margin-right: 5px;\n"]);return W=function(){return e},e}var q=f.a.img(W(),function(e){return J(e.type)?60:3},function(e){return J(e.type)?"":"height: auto"}),J=function(e){return"Channel"===e||"Playlist"===e},Q=n(6),X=n(4),Y=function(){return Math.random()+""};var G=function(e,t){if(!e)throw new Error("Expected parent for node "+t+", but not "+e);return e},$=function(e,t,n){return Object(X.a)({},e,Object(Q.a)({},t,Object(X.a)({},e[t],n(e[t]))))},Z=function(e,t){var n=G(ee(e,t),t);return $(e,n,function(e){return{children:(n=e.children,r=t,n?n.filter(function(e){return e!==r}):[])};var n,r})},_=function(e,t){return function(e){if(!e||0===e.length)throw new Error("Expected a non-empty array "+e);return e[0]}(te(e,t))},ee=function(e,t){return Object.keys(e).find(function(n){return r=e[n].children,i=t,!!r&&r.indexOf(i)>=0;var r,i})},te=function(e,t){for(var n=[t],r=ee(e,t);r;)n=[r].concat(n),r=ee(e,r);return n},ne=n(59),re=function(e,t){return $(e,t,function(){return{isLoading:!0}})},ie=function(e,t,n){var r=n.map(function(e){return e.id}),i=n.reduce(function(e,t){return function(e,t){return Object(X.a)({},e,Object(Q.a)({},t.id,t))}(e,t)},e);return $(i,t,function(){return{children:r,isLoading:!1,isHidden:!1}})},ae=function(e,t){return $(e,t,function(e){return{isHidden:!e.isHidden}})},oe=function(e,t){if(t.itemBeingDragged===t.id)return e;if(ue(e,t)){var n=Y(),r=Object(X.a)({},t,{itemBeingDragged:n});return ce(function e(t,n,r){var i,a=t[n].children;if(a){var o=a.map(function(){return Y()});i=o.reduce(function(t,n,r){return e(t,a[r],n)},t),i=$(i,r,function(e){return Object(X.a)({},e,{children:o})})}else i=t;return Object(X.a)({},i,Object(Q.a)({},r,Object(X.a)({},i[n],{children:i[r]?i[r].children:void 0,id:r})))}(e,t.itemBeingDragged,n),r)}return ce(Z(e,t.itemBeingDragged),t)},ce=function(e,t){if(0!==t.dragLevel){var n=function(e,t){return te(e,t).length-2}(e,t.id);if(t.dragLevel>n)return $(e,t.id,function(e){return{children:[t.itemBeingDragged].concat(e.children||[])}})}var r=G(ee(e,t.id),t.id);return $(e,r,function(e){return{children:de(e.children,t)}})},ue=function(e,t){return _(e,t.id)!==_(e,t.itemBeingDragged)};function de(e,t){var n=e.indexOf(t.id),r="AFTER"===t.orientation?n+1:n,i=Object(ne.a)(e);return i.splice(r,0,t.itemBeingDragged),i}var le=Object(u.DragDropContext)(l.a)(function(e){var t=e.children;return i.a.createElement(r.Fragment,null,t)}),se=Object(u.DragSource)("NODE",{beginDrag:function(e){return{id:e.node.id}},endDrag:function(e,t){t.didDrop()||e.setPlacement({id:""})}},function(e){return{connectDragSource:e.dragSource()}});var fe,pe=Object(u.DropTarget)("NODE",{drop:function(e){e.setNodes(oe(e.nodes,e.placement)),e.setPlacement({id:""})},hover:function(e,t,n){if(!n)return null;var r=n.getNode();if(!r)return null;var i,a,o=function(e){return e.getBoundingClientRect()}(r),c=function(e){return e.getClientOffset()}(t),u=(i=o,a=c.y,(i.bottom+i.top)/2>=a?"BEFORE":"AFTER"),d=Math.max(c.x-15-o.x,0),l=Math.floor(d/20),s=G(ee(e.nodes,e.node.id),e.node.id),f=0===(e.nodes[s].children||[]).indexOf(e.node.id),p="BEFORE"===u&&f?e.level:e.level+1,m=l>p?p:l,v={itemBeingDragged:t.getItem().id,id:e.node.id,orientation:u,dragLevel:m};e.setPlacement(v)}},function(e){return{connectDropTarget:e.dropTarget()}});!function(e){e.FAVORITES="ROOT.favorites",e.SEARCH="ROOT.search"}(fe||(fe={}));var me=Object(X.a)({},ve("1",["1.1","1.2"]),ve("1.1"),ve("1.2",["1.2.1"]),ve("1.2.1"),ve("2",["2.1"]),ve("2.1",["2.1.1"]),ve("2.1.1"),ve("Ambient",["Carbon Based Lifeforms Album 1","Carbon Based Lifeforms Album 2"]),he("Carbon Based Lifeforms Album 1","f5ddAAYasgM","https://picsum.photos/id/190/132/132?grayscale"),he("Carbon Based Lifeforms Album 2","KQE29az48gM","https://picsum.photos/id/191/132/132?grayscale"),function(e,t,n){var r={id:e,text:e,type:"Playlist",imageUrl:n,playlistId:t};return Object(Q.a)({},e,r)}("MyPlaylist","MyPlaylistId","https://picsum.photos/id/192/132/132?grayscale"),ge(["1","2"],fe.FAVORITES),ge(["Ambient"],fe.SEARCH));function ve(e,t){var n={id:e,text:"Node "+e,children:t,type:"Composite"};return Object(Q.a)({},e,n)}function he(e,t,n){var r={id:e,text:e,type:"Video",imageUrl:n,videoUrl:t};return Object(Q.a)({},e,r)}function ge(e,t){var n={id:t,text:t,children:e,type:"Root"};return Object(Q.a)({},t,n)}var be=n(56),ye=function(e){return i.a.createElement("div",{style:Oe},i.a.createElement(be.a,Object.assign({},e,{onReady:function(t){return e.onReady(t.target)},"data-testid":"player",opts:{height:"150",width:"220",playerVars:{autoplay:1}}})))},Oe={position:"absolute",right:15,bottom:15},Ee=function(e){var t=e.videoId,n=Object(r.useState)(),a=Object(c.a)(n,2),o=(a[0],a[1]);return t?i.a.createElement(ye,{onReady:o,videoId:t}):null},je="AIzaSyBsCL-zrXWd9S2FKRSDVfz7dOo783LQkLk",xe=function(e){return"youtube#video"===e||"youtube#playlist"===e||"youtube#channel"===e},we=function(e){return"youtube#video"===e.id.kind?Ie(e):"youtube#playlist"===e.id.kind?Ce(e):ke(e)},Ie=function(e){return Object(X.a)({},De(e),{videoId:e.id.videoId,type:"Video"})},Ce=function(e){return Object(X.a)({},De(e),{playlistId:e.id.playlistId,type:"Playlist"})},ke=function(e){return Object(X.a)({},De(e),{channelId:e.id.channelId,type:"Channel"})},De=function(e){return{title:e.snippet.title,previewUrl:e.snippet.thumbnails.default.url}},Re=function(e,t){return console.log("Requesting Youtube ".concat(t," for ").concat(e)),e},Se=function(e){return e.items.map(Ae)},Ae=function(e){return Object(X.a)({id:Y(),text:e.title},Be(e),{imageUrl:e.previewUrl,isHidden:!0})},Be=function(e){return{type:Pe(e.type),videoUrl:e.videoId,channelId:e.channelId,playlistId:e.playlistId}},Pe=function(e){return"Video"===e?"Video":"Playlist"===e?"Playlist":"Channel"},Te=function(e){var t=e.nodes,n=e.node,a=e.setNodes,o=Object(r.useState)(!1),u=Object(c.a)(o,2),d=u[0],l=u[1],s=Object(r.useState)(),f=Object(c.a)(s,2),p=f[0],m=f[1],v=function(){a(function(e,t,n){return $(e,t,function(){return{text:n}})}(t,n.id,p)),l(!1)},h=function(e){return a(function(e,t){return Z(e,t)}(t,e))};return i.a.createElement(r.Fragment,null,d?i.a.createElement("input",{"data-testid":"input-"+n.id,onBlur:v,autoFocus:!0,onKeyPress:function(e){"Enter"===e.key&&v()},type:"text",value:p,onChange:function(e){return m(e.target.value)}}):i.a.createElement(r.Fragment,null,i.a.createElement(U,{"data-testid":"title-"+n.id},n.text),n.isLoading&&i.a.createElement("span",{"data-testid":"loading-"+n.id},"Loading...")),i.a.createElement(z,{nodeId:n.id,onEdit:function(){m(n.text),l(!0)},onDelete:function(){return h(n.id)}}))},Fe=pe(se(i.a.forwardRef(function(e,t){var n=e.children,a=e.node,o=e.level,c=e.connectDragSource,u=e.connectDropTarget,d=e.placement,l=e.onPlay,s=e.setNodes,f=e.nodes,p=Object(r.useRef)(null);Object(r.useImperativeHandle)(t,function(){return u(p),{getNode:function(){return p.current}}});var v=function(e){var t,n,r=f[e].children;r&&r.length>0?s(ae(f,e)):"Video"===f[e].type?(s(re(f,e)),(n=f[e].videoUrl,fetch("https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&key=".concat(je,"&relatedToVideoId=")+Re(n,"search similar")).then(function(e){return e.json()}).then(function(e){return{items:e.items.filter(function(e){return e.id.videoId}).map(function(e){return{title:e.snippet.title,type:"Video",videoId:e.id.videoId,previewUrl:e.snippet.thumbnails.default.url}})}})).then(function(t){var n;s(ie(f,e,(n=Se(t),console.log(n),n)))})):"Playlist"===f[e].type?(s(re(f,e)),(t=f[e].playlistId,Re(t,"playlistItems"),fetch("https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=".concat(t,"&key=").concat(je,"&maxResults=20")).then(function(e){return e.json()}).then(function(e){return{items:e.items.map(function(e){return{title:e.snippet.title,type:"Video",videoId:e.snippet.resourceId.videoId,previewUrl:e.snippet.thumbnails.default.url}})}})).then(function(t){return s(ie(f,e,Se(t)))})):s(ae(f,e))};return i.a.createElement("div",null,i.a.createElement(m,{"data-testid":"node-"+a.id,level:o,ref:p},i.a.createElement(y,{orientation:a.isHidden?"right":"down",nodeId:a.id,onClick:function(){return v(a.id)}}),"Composite"!==a.type?i.a.createElement(q,{type:a.type,alt:"Cover image",onClick:function(){return l(a)},ref:c,src:a.imageUrl,"data-testid":"video-image-".concat(a.id)}):i.a.createElement(F,{node:a,ref:c}),i.a.createElement(Te,{setNodes:s,nodes:f,node:a}),a.id===d.id&&i.a.createElement(w,{placement:d,level:o,"data-testid":"border-"+a.id})),n)}))),Le=function(e,t){t.forEach(function(t){if(!e[t]){var n=ee(e,t);throw new Error("Node '".concat(n,"' contains a non-existing child '").concat(t,"'. Check children of '").concat(n,"'"))}})},Ve=function(e){return e.children&&!e.isHidden},Ne=function e(t){var n=t.nodes,a=t.ids,o=t.level;return Le(n,a),i.a.createElement(r.Fragment,null,a.map(function(r){return i.a.createElement(Fe,Object.assign({},t,{key:r,node:n[r],level:o}),Ve(n[r])&&i.a.createElement(e,Object.assign({},t,{ids:n[r].children,level:o+1})))}))},He=function(e){var t=e.renderRight,n=e.renderLeft,a=e.onSearchDone,o=Object(r.useState)(!1),u=Object(c.a)(o,2),d=u[0],l=u[1],s=d?{flex:1}:{width:40,backgroundColor:"lightGrey"};return i.a.createElement("div",{style:{flexDirection:"row",display:"flex",alignItems:"stretch",height:"100vh"}},i.a.createElement("div",{style:s,"data-testid":"search-zone"},i.a.createElement(Ue,{isVisible:d,onSearchDone:a,onClick:function(){return l(!d)},renderTree:n})),i.a.createElement("div",{style:{flex:1},"data-testid":"favorites-zone"},t()))},Ue=function(e){var t=e.isVisible,n=e.onClick,a=e.renderTree,o=e.onSearchDone,u=Object(r.useState)(""),d=Object(c.a)(u,2),l=d[0],s=d[1],f=function(e,t){var n=Object(r.useState)(e),i=Object(c.a)(n,2),a=i[0],o=i[1];return Object(r.useEffect)(function(){var n=setTimeout(function(){o(e)},t);return function(){clearTimeout(n)}},[e,t]),a}(l,500);return Object(r.useEffect)(function(){var e;f&&(e=f,fetch("https://www.googleapis.com/youtube/v3/search?part=snippet&shart=mostPopular&maxResults=10&key=".concat(je,"&q=")+Re(e,"search")).then(function(e){return e.json()}).then(function(e){return{items:e.items.filter(function(e){return xe(e.id.kind)}).map(we)}})).then(o)},[f]),i.a.createElement("div",null,i.a.createElement("div",{style:{display:"flex",justifyContent:t?"flex-end":"center",paddingRight:t?20:0}},i.a.createElement("button",{"data-testid":"toggle-sidebar",onClick:n},t?"<":"+")),t&&i.a.createElement("input",{"data-testid":"search-input",type:"text",value:l,onChange:function(e){return s(e.target.value)}}),t&&a())},Me=function(e){var t=e.processDefaultNodes,n=Object(r.useState)(t?t(me):me),a=Object(c.a)(n,2),o=a[0],u=a[1],d=Object(r.useState)({}),l=Object(c.a)(d,2),s=l[0],f=l[1],p=Object(r.useState)({}),m=Object(c.a)(p,2),v=m[0],h=m[1],g=function(e){return h(e)},b=function(e){(function(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),r=Object.keys(t),i=n.length;if(r.length!==i)return!1;for(var a=0;a<i;a++){var o=n[a];if(e[o]!==t[o])return!1}return!0})(e,s)||(console.count("called set placement"),f(e))},y=function(){return u(function(e,t){var n=Math.random()+"",r={text:"New Node",type:"Composite",id:n},i=$(e,t,function(e){return{children:e.children.concat([n])}});return Object(X.a)({},i,Object(Q.a)({},n,r))}(o,fe.FAVORITES))};return i.a.createElement("div",null,i.a.createElement(le,null,i.a.createElement(He,{onSearchDone:function(e){var t;u(ie(o,fe.SEARCH,(t=Se(e),console.log(t),t)))},renderRight:function(){return i.a.createElement(r.Fragment,null,i.a.createElement(Ne,{nodes:o,ids:o[fe.FAVORITES].children,level:0,setPlacement:b,setNodes:u,onPlay:g,placement:s}),i.a.createElement("button",{"data-testid":"add-new-node",onClick:y},"add"))},renderLeft:function(){return i.a.createElement(Ne,{nodes:o,ids:o[fe.SEARCH].children,level:0,onPlay:g,setPlacement:b,setNodes:u,placement:s})}})),i.a.createElement(Ee,{videoId:v.videoUrl}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Me,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},52:function(e,t,n){e.exports=n.p+"static/media/folder-closed.5f8d5aa0.svg"},53:function(e,t,n){e.exports=n.p+"static/media/folder-opened-many.f8af0c07.svg"},54:function(e,t,n){e.exports=n.p+"static/media/folder-opened-single.cfca5246.svg"},55:function(e,t,n){e.exports=n.p+"static/media/folder-opened-empty.feffd839.svg"},61:function(e,t,n){e.exports=n(132)},66:function(e,t,n){}},[[61,1,2]]]);
//# sourceMappingURL=main.bdd5f831.chunk.js.map