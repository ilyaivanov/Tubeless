{"version":3,"sources":["tree/components/NodeContainer.ts","tree/components/constants.tsx","tree/components/Common.ts","tree/components/Arrow.tsx","tree/components/Border.ts","tree/components/Bullet.tsx","tree/components/NodeText.ts","tree/components/NodeIcons.tsx","tree/components/VideoPreview.ts","utils/createId.ts","tree/treeValidation.ts","tree/types.ts","tree/treeOperations.ts","utils/arrayOperations.ts","tree/sampleTrees.ts","keys.ts","youtube/api.ts","youtube/mapVideosToNodes.ts","tree/treeActions.ts","tree/dnd.tsx","tree/offsetHandler.ts","player/index.tsx","tree/NodeTitle.tsx","tree/Node.tsx","tree/Tree.tsx","App.tsx","utils/useDebounce.ts","utils/shallowEqual.ts","serviceWorker.ts","index.tsx","tree/components/icons/folder-closed-withItems.svg","tree/components/icons/folder-closed-loader.svg","tree/components/icons/folder-closed-empty.svg","tree/components/icons/folder-opened-many.svg","tree/components/icons/folder-opened-single.svg","tree/components/icons/folder-opened-empty.svg"],"names":["NodeContainer","styled","div","_templateObject","props","level","Center","Common_templateObject","Arrow","react_default","a","createElement","ArrowContainer","onClick","ArrowIcon","data-testid","nodeId","orientation","Arrow_templateObject","getStyleForOrientation","_templateObject2","smallSide","toFixed","concat","width","Border","Border_templateObject","placement","dragLevel","Bullet","React","forwardRef","_ref","ref","node","CircleContainer","id","Img","src","getFolderIcon","alt","height","isHidden","children","length","FolderClosedNonEmpty","loader","FolderClosedLoader","FolderClosedEmpty","FolderOpenedMany","FolderOpenedSingle","FolderOpenedEmpty","img","Bullet_templateObject","Bullet_templateObject2","NodeText","span","NodeText_templateObject","NodeIcons","onEdit","onDelete","IconsContainer","NodeIcons_templateObject","VideoPreview","VideoPreview_templateObject","hasRoundImage","type","nodeType","createId","Math","random","Roots","validateParent","parentId","Error","updateNode","nodes","updated","Object","objectSpread","defineProperty","deleteNode","parent","getParentKey","items","item","filter","i","getRootKey","array","first","getNodePath","keys","find","key","indexOf","path","options","sampleNodes","channelId","createPlaylistLoader","video","label","playlistId","imageUrl","text","playlist","root","FAVORITES","SEARCH","videoUrl","rootType","searchVideos","term","pageToken","fetch","url","part","shart","maxResults","q","logRequest","then","response","json","data","nextPageToken","totalResults","pageInfo","isItemSupported","kind","map","parseItem","itemKind","parseVideo","parsePlaylist","parseChannel","mapTitle","snippet","previewUrl","thumbnails","default","videoId","title","handleTitle","replace","requestType","console","log","defaultProps","fetchJson","res","verb","allProps","join","parseProps","mapVideosToNodes","mapItem","getSpecific","getNodeType","onSearchStart","isLoading","loadMoreItems","setNodes","relatedToVideoId","v","s","onSearchDone","resourceId","getPlaylistVideos","order","getChannelVideos","addPlaylistsLoader","getPlaylistsForChannel","newVideoNodes","shouldOverride","n","withNodes","reduce","state","createNode","withChildren","setNodePageInformation","titlePostfix","getChildCount","toggleVisibility","onDrop","itemBeingDragged","isDraggingFromDifferentScopes","newId","newPlacement","insertNode","copyNodeDeep","newNodeId","newNodes","newIds","index","undefined","nodeLevel","getNodeLevel","insertDragItemAtPlacement","context","action","targetIndex","copy","toConsumableArray","splice","DragContext","DragDropContext","HTML5Backend","react","TreeDragSource","DragSource","beginDrag","endDrag","monitor","didDrop","setPlacement","connect","connectDragSource","dragSource","TreeDropTarget","DropTarget","drop","hover","component","getNode","rect","yPosition","hoverBoundingRect","getBoundingClientRect","clientOffset","getClientOffset","y","bottom","top","offsetWithoutArrow","max","x","floor","isFirst","maxDragLevel","desiredDragLevel","desiredPlacement","getItem","connectDropTarget","dropTarget","YoutubePlayerWrapper","style","YouTube","assign","onReady","e","target","onEnd","opts","playerVars","autoplay","position","right","Player","_useState","useState","_useState2","slicedToArray","setPlayer","player_YoutubePlayerWrapper","NodeTitle","isEditing","setIsEditing","_useState3","_useState4","setText","endEdit","newText","onRenameNode","onDeleteNode","onBlur","autoFocus","onKeyPress","value","onChange","fontSize","color","NodeIcons_NodeIcons","onPlay","elementRef","useRef","useImperativeHandle","current","Arrow_Arrow","onToggleCollapse","tree_NodeTitle","marginLeft","validateChildren","forEach","hasChildren","Tree","ids","Node","LayoutManager","_ref2","renderRight","renderLeft","searchNode","_useState7","_useState8","seachVisible","setSearchVisibility","flex","backgroundColor","flexDirection","display","alignItems","App_Search","isVisible","renderTree","Search","_ref3","_useState9","_useState10","setValue","throttledValue","delay","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","useDebounce","justifyContent","paddingRight","App","processDefaultNodes","updateNodes","window","localStorage","setItem","JSON","stringify","parse","_useState5","_useState6","nodeBeingPlayed","setNodeBeingPlayer","updatePlacementOptimized","objA","objB","aKeys","bKeys","len","shallowEqual","count","addNewNodeForFavorites","withChild","onCreateNode","App_LayoutManager","override","tree_Tree","src_player","next","getNextNodeId","removeItem","Boolean","location","hostname","match","ReactDOM","render","src_App","document","getElementById","navigator","serviceWorker","ready","registration","unregister","module","exports","__webpack_require__","p"],"mappings":"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","file":"static/js/main.870aa878.chunk.js","sourcesContent":["import styled from \"styled-components\";\nimport { LEVEL_SHIFT } from \"./constants\";\n\ninterface NodeContainerProps {\n  level: number;\n}\n\nexport const NodeContainer = styled.div<NodeContainerProps>`\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-top: 2px;\n  padding-bottom: 2px;\n  padding-left: ${(props: NodeContainerProps) => props.level * LEVEL_SHIFT}px;\n`;\n","export const ARROW_SIZE = 15;\n\nexport const LEVEL_SHIFT = 20;\n","import styled from \"styled-components\";\n\nexport const Center = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n","import styled from \"styled-components\";\nimport React, { MouseEventHandler } from \"react\";\nimport { ARROW_SIZE } from \"./constants\";\nimport { NodeContainer } from \"./NodeContainer\";\nimport { Center } from \"./Common\";\n\ntype ArrowIconOrientation = \"right\" | \"down\";\n\ninterface ArrowProps {\n  nodeId: string;\n  onClick: MouseEventHandler;\n  orientation: ArrowIconOrientation;\n}\n\nexport const Arrow = (props: ArrowProps) => (\n  <ArrowContainer onClick={props.onClick}>\n    <ArrowIcon\n      data-testid={\"arrow-\" + props.nodeId}\n      orientation={props.orientation}\n    />\n  </ArrowContainer>\n);\n\ninterface ArrowIconProps {\n  orientation: ArrowIconOrientation;\n}\n\nconst ArrowIcon = styled.div<ArrowIconProps>`\n  width: 0;\n  height: 0;\n  border-style: solid;\n  ${(props: ArrowIconProps) => getStyleForOrientation(props.orientation)};\n  visibility: hidden;\n  ${NodeContainer}:hover & {\n    visibility: visible;\n  }\n`;\n\nconst ArrowContainer = styled(Center)`\n  height: ${ARROW_SIZE}px;\n  width: ${ARROW_SIZE}px;\n  min-width: ${ARROW_SIZE}px;\n`;\n\nconst getStyleForOrientation = (orientation: ArrowIconOrientation) => {\n  const width = 8;\n  const side = width / 2;\n  const smallSide = (side * 1.73205).toFixed(1);\n  const color = \"rgb(75, 81, 85)\";\n  if (orientation === \"right\") {\n    return `\n    border-width: ${side}px 0 ${side}px ${smallSide}px;\n    border-color: transparent transparent transparent ${color};\n  `;\n  } else\n    return `  \n    border-width: ${smallSide}px ${side}px 0 ${side}px;\n    border-color: ${color} transparent transparent transparent;\n    `;\n};\n","import styled from \"styled-components\";\nimport { ARROW_SIZE, LEVEL_SHIFT } from \"./constants\";\n\nexport const Border = styled.div`\n  height: 2px;\n  background-color: grey;\n  position: absolute;\n  left: ${(props: any) =>\n    ARROW_SIZE + props.placement.dragLevel * LEVEL_SHIFT}px;\n  right: 0;\n  ${(props: any) =>\n    props.placement.orientation === \"AFTER\" ? \"bottom: -1px\" : \"top: -1px\"};\n` as any;\n","import styled from \"styled-components\";\nimport React, { Ref } from \"react\";\nimport { Node } from \"../types\";\nimport FolderClosedNonEmpty from \"./icons/folder-closed-withItems.svg\";\nimport FolderClosedLoader from \"./icons/folder-closed-loader.svg\";\nimport FolderClosedEmpty from \"./icons/folder-closed-empty.svg\";\nimport FolderOpenedMany from \"./icons/folder-opened-many.svg\";\nimport FolderOpenedSingle from \"./icons/folder-opened-single.svg\";\nimport FolderOpenedEmpty from \"./icons/folder-opened-empty.svg\";\nimport { NodeContainer } from \"./NodeContainer\";\n\ninterface BulletProps {\n  node: Node;\n}\n\nconst FOLDER_SIZE = 25;\n\nexport const Bullet = React.forwardRef(\n  ({ node }: BulletProps, ref: Ref<HTMLDivElement>) => (\n    <CircleContainer ref={ref} data-testid={\"drag-handle-\" + node.id}>\n      <Img\n        src={getFolderIcon(node)}\n        alt=\"\"\n        width={FOLDER_SIZE}\n        height={FOLDER_SIZE}\n      />\n    </CircleContainer>\n  )\n);\n\nconst getFolderIcon = (node: Node) => {\n  if (node.isHidden) {\n    if (node.children && node.children.length > 0) return FolderClosedNonEmpty;\n    if (node.loader) return FolderClosedLoader;\n    return FolderClosedEmpty;\n  }\n  const children = node.children;\n\n  if (!children) return FolderOpenedEmpty;\n\n  if (children.length > 1) return FolderOpenedMany;\n  else return FolderOpenedSingle;\n};\n\nconst Img = styled.img`\n  filter: invert(0.3);\n  ${NodeContainer}:hover & {\n    filter: invert(0);\n  }\n`;\n\nexport const CircleContainer = styled.div`\n  margin-right: 5px;\n`;\n","import styled from \"styled-components\";\n\nexport const NodeText = styled.span``;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { NodeContainer } from \"./NodeContainer\";\n\ninterface Props {\n  nodeId: string;\n  onEdit: () => void;\n  onDelete: () => void;\n}\n\nconst NodeIcons = ({ onEdit, onDelete, nodeId }: Props) => (\n  <IconsContainer>\n    <button data-testid={\"edit-\" + nodeId} onClick={onEdit}>\n      E\n    </button>\n    <button data-testid={\"delete-\" + nodeId} onClick={onDelete}>\n      X\n    </button>\n  </IconsContainer>\n);\n\nconst IconsContainer = styled.div`\n  visibility: hidden;\n  ${NodeContainer}:hover & {\n    visibility: visible;\n  }\n  padding-left: 10px;\n`;\n\nexport { NodeIcons };\n","import styled from \"styled-components\";\nimport { NodeType } from \"../types\";\n\ninterface Props {\n  type: NodeType;\n}\n\nexport const VideoPreview = styled.img<Props>`\n  height: 32px;\n  width: 32px;\n\n  max-width: 100%;\n\n  border-radius: ${(props: Props) => (hasRoundImage(props.type) ? 60 : 3)}px;\n\n  ${(props: Props) => (hasRoundImage(props.type) ? \"\" : \"height: auto\")};\n  margin-right: 5px;\n`;\n\nconst hasRoundImage = (nodeType: NodeType) =>\n  nodeType === \"Channel\" || nodeType === \"Playlist\";\n","export const createId = (): string => {\n  return Math.random() + \"\";\n};\n","export const validateParent = (\n  parentId: string | undefined,\n  nodeId: string\n): string => {\n  if (!parentId)\n    throw new Error(\n      \"Expected parent for node \" + nodeId + \", but not \" + parentId\n    );\n  return parentId;\n};\n","export type NodeType = \"Video\" | \"Playlist\" | \"Channel\" | \"Root\" | \"Composite\";\n\nexport type LoaderType = \"Playlists\";\n\nexport type Loader = {\n  type: LoaderType;\n  channelId: string;\n};\n\nexport interface Node {\n  id: string;\n  text: string;\n  children?: string[];\n  isHidden?: boolean;\n  isLoading?: boolean;\n\n  type: NodeType;\n\n  loader?: Loader;\n  videoUrl?: string;\n  channelId?: string;\n  playlistId?: string;\n  imageUrl?: string;\n\n\n  //paging\n  titlePostfix?: string;\n  nextPageToken?: string;\n}\n\nexport interface Nodes {\n  [id: string]: Node;\n}\n\nexport type PlacementOrientation = \"BEFORE\" | \"AFTER\";\n\nexport type Placement = {\n  id: string;\n  orientation: PlacementOrientation;\n  dragLevel: number;\n  itemBeingDragged: string;\n};\n\nexport enum Roots {\n  FAVORITES = \"ROOT.favorites\",\n  SEARCH = \"ROOT.search\"\n}\n","import { Node, Nodes } from \"./types\";\nimport { createId, contains, except, first } from \"../utils\";\nimport { validateParent } from \"./treeValidation\";\n\nexport const createNode = (nodes: Nodes, node: Node): Nodes => {\n  return { ...nodes, [node.id]: node };\n};\n\nexport const updateNode = (\n  nodes: Nodes,\n  id: string,\n  updated: (node: Node) => Partial<Node>\n): Nodes => {\n  return {\n    ...nodes,\n    [id]: {\n      ...nodes[id],\n      ...updated(nodes[id])\n    }\n  };\n};\n\nexport const deleteNode = (nodes: Nodes, nodeId: string) => {\n  const parent = validateParent(getParentKey(nodes, nodeId), nodeId);\n  const res = updateNode(nodes, parent, node => ({\n    children: except(node.children, nodeId)\n  }));\n  return res;\n};\n\nexport const getNodeLevel = (nodes: Nodes, nodeId: string) =>\n  getNodePath(nodes, nodeId).length - 2;\n\nexport const getRootKey = (nodes: Nodes, nodeId: string): string =>\n  first(getNodePath(nodes, nodeId));\n\nexport const getParentKey = (\n  nodes: Nodes,\n  nodeId: string\n): string | undefined =>\n  Object.keys(nodes).find(key => contains(nodes[key].children, nodeId));\n\nconst getNodePath = (nodes: Nodes, nodeId: string) => {\n  let path = [nodeId];\n  let parent = getParentKey(nodes, nodeId);\n  while (parent) {\n    path = [parent].concat(path);\n    parent = getParentKey(nodes, parent);\n  }\n  return path;\n};\n\n//TODO: ugly code, consider to refactor it\nexport const copyNodeDeep = (\n  nodes: Nodes,\n  nodeId: string,\n  newNodeId: string\n): Nodes => {\n  let newNodes;\n  const children = nodes[nodeId].children;\n  if (children) {\n    const newIds = children.map(() => createId());\n\n    newNodes = newIds.reduce((state, newId, index) => {\n      return copyNodeDeep(state, children[index], newId);\n    }, nodes);\n    newNodes = updateNode(newNodes, newNodeId, node => ({\n      ...node,\n      children: newIds\n    }));\n  } else {\n    newNodes = nodes;\n  }\n  return {\n    ...newNodes,\n    [newNodeId]: {\n      ...newNodes[nodeId],\n      children: newNodes[newNodeId] ? newNodes[newNodeId].children : undefined,\n      id: newNodeId\n    }\n  };\n};\n\nexport const getNextNodeId = (nodes: Nodes, nodeId: string) => {\n  const parentKey = getParentKey(nodes, nodeId) as string;\n  const parent = nodes[parentKey];\n  if (parent.children) {\n    const index = parent.children.indexOf(nodeId);\n    return parent.children[index + 1];\n  }\n  throw new Error(\"Expected node to have children\");\n};\n","export function contains<T>(array: T[] | undefined, item: T): boolean {\n  return !!array && array.indexOf(item) >= 0;\n}\n\nexport function first<T>(array: T[]): T {\n  if (!array || array.length === 0)\n    throw new Error(\"Expected a non-empty array \" + array);\n  return array[0];\n}\n\nexport function except<T>(items: T[] | undefined, item: T): T[] {\n  if (!items) return [];\n  return items.filter(i => i !== item);\n}\n\n","import { Node, Nodes, NodeType, Roots } from \"./types\";\nimport { createId } from \"../utils\";\n\nconst sampleNodes: Nodes = {\n  ...node(\"1\", [\"1.1\", \"1.2\"]),\n  ...node(\"1.1\"),\n  ...node(\"1.2\", [\"1.2.1\"]),\n  ...node(\"1.2.1\"),\n  ...node(\"2\", [\"2.1\"]),\n  ...node(\"2.1\", [\"2.1.1\"]),\n  ...node(\"2.1.1\"),\n  ...createLoader(\"Loading Google Playlists\", {\n    channelId: \"UC_x5XG1OV2P6uZZ5FSM9Ttw\"\n  }),\n  ...node(\"Ambient\", [\n    \"Carbon Based Lifeforms Album 1\",\n    \"Carbon Based Lifeforms Album 2\"\n  ]),\n  ...video(\n    \"Carbon Based Lifeforms Album 1\",\n    \"f5ddAAYasgM\",\n    \"https://picsum.photos/id/190/132/132?grayscale\"\n  ),\n  ...video(\n    \"Carbon Based Lifeforms Album 2\",\n    \"KQE29az48gM\",\n    \"https://picsum.photos/id/191/132/132?grayscale\"\n  ),\n  ...playlist(\n    \"MyPlaylist\",\n    \"MyPlaylistId\",\n    \"https://picsum.photos/id/192/132/132?grayscale\"\n  ),\n  ...root([\"1\", \"2\", \"Loading Google Playlists\"], Roots.FAVORITES),\n  ...root([\"Ambient\"], Roots.SEARCH)\n};\n\nexport { sampleNodes };\n\nexport function node(id: string, children?: string[]) {\n  const node: Node = {\n    id,\n    text: \"Node \" + id,\n    children,\n    type: \"Composite\"\n  };\n  return {\n    [id]: node\n  };\n}\n\nfunction video(label: string, videoUrl: string, imageUrl: string) {\n  const node: Node = {\n    id: label,\n    text: label,\n    type: \"Video\",\n    imageUrl,\n    videoUrl\n  };\n  return {\n    [label]: node\n  };\n}\n\nfunction playlist(label: string, playlistId: string, imageUrl: string) {\n  const node: Node = {\n    id: label,\n    text: label,\n    type: \"Playlist\",\n    imageUrl,\n    playlistId\n  };\n  return {\n    [label]: node\n  };\n}\n\nfunction createLoader(id: string, options: { channelId: string }) {\n  return {\n    [id]: {\n      ...createPlaylistLoader(options.channelId),\n      id\n    }\n  };\n}\n\nexport function createPlaylistLoader(channelId: string): Node {\n  return {\n    id: createId(),\n    text: \"Playlists\",\n    type: \"Composite\",\n    isHidden: true,\n    loader: {\n      type: \"Playlists\",\n      channelId\n    }\n  };\n}\n\nexport function root(nodes: string[], rootType: Roots) {\n  const node: Node = {\n    id: rootType,\n    text: rootType,\n    children: nodes,\n    type: \"Root\"\n  };\n  return {\n    [rootType]: node\n  };\n}\n","export const YOUTUBE_KEY = \"AIzaSyBsCL-zrXWd9S2FKRSDVfz7dOo783LQkLk\";\n\n// Get playlists for Channel\n// https://www.googleapis.com/youtube/v3/playlists?part=snippet%2CcontentDetails&channelId=UC_x5XG1OV2P6uZZ5FSM9Ttw&maxResults=25&key=AIzaSyBsCL-zrXWd9S2FKRSDVfz7dOo783LQkLk\n\n// Get videos for Channel\n// https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=UC_x5XG1OV2P6uZZ5FSM9Ttw&maxResults=20&order=date&type=video&key=AIzaSyBsCL-zrXWd9S2FKRSDVfz7dOo783LQkLk\n","import {\n  ItemKind,\n  ItemsItem,\n  YoutubeSearchResponse\n} from \"./types/youtubeSearchResponse\";\nimport { YOUTUBE_KEY } from \"../keys\";\nimport { IS_REAL_API } from \"../featureToggles\";\nimport { searchFaked } from \"./types/fakedResponses\";\nimport { SimilarResponse } from \"./types/similarResponse\";\nimport { PlaylistVideosResponse } from \"./types/PlaylistVideosResponse\";\n\nexport type ItemType = \"Video\" | \"Channel\" | \"Playlist\";\n\ninterface Item {\n  title: string;\n  previewUrl: string;\n}\n\ninterface VideoItem extends Item {\n  type: \"Video\";\n  videoId: string;\n}\n\ninterface ChannelItem extends Item {\n  type: \"Channel\";\n  channelId: string;\n}\n\ninterface PlaylistItem extends Item {\n  type: \"Playlist\";\n  playlistId: string;\n}\n\nexport type SearchItem = VideoItem | ChannelItem | PlaylistItem;\n\nexport interface YoutubeResponse {\n  nextPageToken?: string;\n  totalResults?: number;\n  items: SearchItem[];\n}\n\nexport const searchVideos = (\n  term: string,\n  pageToken?: string\n): Promise<YoutubeResponse> =>\n  IS_REAL_API\n    ? fetch(\n        url(\"search\", {\n          part: \"snippet\",\n          shart: \"mostPopular\",\n          maxResults: 10,\n          pageToken,\n          q: logRequest(term, \"search\")\n        })\n      )\n        .then(response => response.json())\n        .then((data: YoutubeSearchResponse) => ({\n          //TODO: extract duplication\n          nextPageToken: data.nextPageToken,\n          totalResults: data.pageInfo.totalResults,\n          items: data.items\n            .filter(item => isItemSupported(item.id.kind))\n            .map(parseItem)\n        }))\n    : Promise.resolve(searchFaked(term));\n\nexport const searchSimilar = (\n  videoId: string,\n  pageToken?: string\n): Promise<YoutubeResponse> =>\n  fetchJson(\n    url(\"search\", {\n      part: \"snippet\",\n      type: \"video\",\n      maxResults: 10,\n      relatedToVideoId: videoId,\n      pageToken\n    })\n  )\n    .then((data: SimilarResponse) => ({\n      //TODO: extract duplication\n      nextPageToken: data.nextPageToken,\n      totalResults: data.pageInfo.totalResults,\n      items: data.items\n        .filter(v => v.id.videoId)\n        .map(s => ({\n          ...mapTitle(s.snippet),\n          type: \"Video\",\n          videoId: s.id.videoId,\n          previewUrl: s.snippet.thumbnails.default.url\n        }))\n    }));\n\nexport const getPlaylistVideos = (\n  playlistId: string,\n  pageToken?: string\n): Promise<YoutubeResponse> => {\n  logRequest(playlistId, \"playlistItems\");\n  if (IS_REAL_API) {\n    return fetchJson(\n      url(\"playlistItems\", {\n        part: \"snippet\",\n        playlistId,\n        maxResults: 20,\n        pageToken\n      })\n    )\n      .then((data: PlaylistVideosResponse) => ({\n        //TODO: extract duplication\n        nextPageToken: data.nextPageToken,\n        totalResults: data.pageInfo.totalResults,\n        items: data.items.map(item => ({\n          ...mapTitle(item.snippet),\n          type: \"Video\",\n          videoId: item.snippet.resourceId.videoId,\n          previewUrl: item.snippet.thumbnails.default.url\n        }))\n      }));\n  }\n  throw new Error(\"Faked playlistItems is not supported yet\");\n};\nexport const getChannelVideos = (\n  channelId: string,\n  pageToken?: string\n): Promise<YoutubeResponse> => {\n  logRequest(channelId, \"videos for channel\");\n  if (IS_REAL_API) {\n    return fetchJson(\n      url(\"search\", {\n        part: \"snippet\",\n        channelId,\n        maxResults: 20,\n        order: \"date\",\n        type: \"video\",\n        pageToken\n      })\n    )\n      .then((data: YoutubeSearchResponse) => ({\n        //TODO: extract duplication\n        nextPageToken: data.nextPageToken,\n        totalResults: data.pageInfo.totalResults,\n        items: data.items.map(parseItem)\n      }));\n  }\n  throw new Error(\"Faked getChannelVideos is not supported yet\");\n};\nexport const getPlaylistsForChannel = (\n  channelId: string,\n  pageToken?: string\n): Promise<YoutubeResponse> => {\n  logRequest(channelId, \"playlists for channel\");\n  if (IS_REAL_API) {\n    return fetchJson(\n      url(\"playlists\", {\n        part: \"snippet%2CcontentDetails\",\n        channelId,\n        maxResults: 25,\n        pageToken\n      })\n    )\n      .then((data: any) => ({\n        //TODO: extract duplication\n        nextPageToken: data.nextPageToken,\n        totalResults: data.pageInfo.totalResults,\n        items: data.items.map((item: any) => ({\n          ...mapTitle(item.snippet),\n          previewUrl: item.snippet.thumbnails.default.url,\n          playlistId: item.id,\n          type: \"Playlist\"\n        }))\n      }));\n  }\n  throw new Error(\"Faked getPlaylistsForChannel is not supported yet\");\n};\n\nconst isItemSupported = (itemKind: ItemKind): boolean =>\n  itemKind === \"youtube#video\" ||\n  itemKind === \"youtube#playlist\" ||\n  itemKind === \"youtube#channel\";\n\nconst parseItem = (item: ItemsItem): SearchItem => {\n  if (item.id.kind === \"youtube#video\") return parseVideo(item);\n  else if (item.id.kind === \"youtube#playlist\") return parsePlaylist(item);\n  else return parseChannel(item);\n};\n\nconst parseVideo = (item: ItemsItem): SearchItem => ({\n  ...mapTitle(item.snippet),\n  previewUrl: item.snippet.thumbnails.default.url,\n  videoId: item.id.videoId as string,\n  type: \"Video\"\n});\n\nconst parsePlaylist = (item: ItemsItem): SearchItem => ({\n  ...mapTitle(item.snippet),\n  previewUrl: item.snippet.thumbnails.default.url,\n  playlistId: item.id.playlistId as string,\n  type: \"Playlist\"\n});\n\nconst parseChannel = (item: ItemsItem): SearchItem => ({\n  ...mapTitle(item.snippet),\n  previewUrl: item.snippet.thumbnails.default.url,\n  channelId: item.id.channelId as string,\n  type: \"Channel\"\n});\n\nconst mapTitle = ({ title }: { title: string }) => ({\n  title: handleTitle(title)\n});\n\nconst handleTitle = (title: string): string =>\n  title.replace(/[^\\x00-\\x7F]/g, \"\");\n\nconst logRequest = (term: string, requestType: string) => {\n  console.log(`Requesting Youtube ${requestType} for ${term}`);\n  return term;\n};\n\nconst defaultProps = {\n  key: YOUTUBE_KEY\n};\n\nconst fetchJson = (url: string) => fetch(url).then(res => res.json());\n\nconst parseProps = (props: any): string => {\n  const allProps = { ...props, ...defaultProps };\n  return Object.keys(allProps)\n    .filter(key => typeof allProps[key] !== \"undefined\")\n    .map(key => `${key}=${allProps[key]}`)\n    .join(\"&\");\n};\nconst url = (verb: string, props: {}) =>\n  `https://www.googleapis.com/youtube/v3/${verb}?${parseProps(props)}`;\n","import { ItemType, SearchItem, YoutubeResponse } from \"./api\";\nimport { Node, NodeType } from \"../tree/types\";\nimport { createId } from \"../utils\";\n\nexport const mapVideosToNodes = (response: YoutubeResponse): Node[] => {\n  return response.items.map(mapItem);\n};\n\nconst mapItem = (item: SearchItem): Node => {\n  return {\n    id: createId(),\n    text: item.title,\n    ...getSpecific(item),\n    imageUrl: item.previewUrl,\n    isHidden: true\n  };\n};\n\nconst getSpecific = (item: SearchItem) => ({\n  type: getNodeType(item.type),\n  videoUrl: (item as any).videoId,\n  channelId: (item as any).channelId,\n  playlistId: (item as any).playlistId\n});\n\n//TODO: Consider not using enums but just simple strings\nconst getNodeType = (type: ItemType): NodeType =>\n  type === \"Video\" ? \"Video\" : type === \"Playlist\" ? \"Playlist\" : \"Channel\";\n","import { Node, Nodes, Placement } from \"./types\";\nimport {\n  copyNodeDeep,\n  createNode,\n  deleteNode,\n  getNodeLevel,\n  getParentKey,\n  getRootKey,\n  updateNode\n} from \"./treeOperations\";\nimport { createId } from \"../utils\";\nimport { validateParent } from \"./treeValidation\";\nimport { createPlaylistLoader } from \"./sampleTrees\";\nimport {\n  getChannelVideos,\n  getPlaylistsForChannel,\n  getPlaylistVideos,\n  searchSimilar,\n  YoutubeResponse\n} from \"../youtube/api\";\nimport { mapVideosToNodes } from \"../youtube/mapVideosToNodes\";\n\nexport const onCreateNode = (nodes: Nodes, parentId: string) => {\n  const id = Math.random() + \"\";\n  const node: Node = {\n    text: \"New Node\",\n    type: \"Composite\",\n    id\n  };\n  const withChild = updateNode(nodes, parentId, node => ({\n    children: (node.children as string[]).concat([id])\n  }));\n  return {\n    ...withChild,\n    [id]: node\n  };\n};\n\nexport const onDeleteNode = (nodes: Nodes, nodeId: string) =>\n  deleteNode(nodes, nodeId);\n\nexport const onRenameNode = (nodes: Nodes, nodeId: string, newText: string) =>\n  updateNode(nodes, nodeId, () => ({\n    text: newText\n  }));\n\nexport const onSearchStart = (nodes: Nodes, nodeId: string) =>\n  updateNode(nodes, nodeId, () => ({\n    isLoading: true\n  }));\n\nconst addPlaylistsLoader = (nodes: Node[], channelId: string): Node[] =>\n  [createPlaylistLoader(channelId)].concat(nodes);\n\nexport const loadMoreItems = (\n  nodes: Nodes,\n  id: string,\n  setNodes: (nodes: Nodes) => void\n) => {\n  if (nodes[id].type === \"Video\") {\n    setNodes(onSearchStart(nodes, id));\n    searchSimilar(nodes[id].videoUrl as string, nodes[id].nextPageToken).then(\n      response =>\n        setNodes(onSearchDone(nodes, id, mapVideosToNodes(response), response))\n    );\n  } else if (nodes[id].type === \"Playlist\") {\n    console.log(nodes[id])\n    setNodes(onSearchStart(nodes, id));\n    getPlaylistVideos(\n      nodes[id].playlistId as string,\n      nodes[id].nextPageToken\n    ).then(response =>\n      setNodes(onSearchDone(nodes, id, mapVideosToNodes(response), response))\n    );\n  } else if (nodes[id].type === \"Channel\") {\n    const channelId = nodes[id].channelId as string;\n    setNodes(onSearchStart(nodes, id));\n    getChannelVideos(channelId, nodes[id].nextPageToken).then(response =>\n      setNodes(\n        onSearchDone(\n          nodes,\n          id,\n          nodes[id].nextPageToken\n            ? mapVideosToNodes(response)\n            : addPlaylistsLoader(mapVideosToNodes(response), channelId),\n          response\n        )\n      )\n    );\n  } else {\n    const loader = nodes[id].loader;\n    if (loader) {\n      if (loader.type === \"Playlists\") {\n        setNodes(onSearchStart(nodes, id));\n        getPlaylistsForChannel(\n          loader.channelId as string,\n          nodes[id].nextPageToken\n        ).then(response =>\n          setNodes(\n            onSearchDone(nodes, id, mapVideosToNodes(response), response)\n          )\n        );\n      } else {\n        throw new Error(\"Unexpected loader: \" + loader.type);\n      }\n    }\n  }\n};\n\n//TODO: there is an issue related to async state updates\nexport const onToggleCollapse = (\n  nodes: Nodes,\n  setNodes: (nodes: Nodes) => void,\n  id: string\n) => {\n  const children = nodes[id].children;\n  if (children && children.length > 0) {\n    setNodes(toggleVisibility(nodes, id));\n  } else {\n    return loadMoreItems(nodes, id, setNodes);\n  }\n};\n\nexport const onSearchDone = (\n  nodes: Nodes,\n  parentId: string,\n  newVideoNodes: Node[],\n  response: YoutubeResponse,\n  shouldOverride?: boolean\n): Nodes => {\n  const children = newVideoNodes.map(n => n.id);\n  const withNodes = newVideoNodes.reduce(\n    (state, node) => createNode(state, node),\n    nodes\n  );\n\n  const withChildren = updateNode(withNodes, parentId, node => ({\n    children: shouldOverride\n      ? children\n      : (node.children || []).concat(children),\n    isLoading: false,\n    isHidden: false\n  }));\n  return setNodePageInformation(withChildren, parentId, response);\n};\n\nconst setNodePageInformation = (\n  nodes: Nodes,\n  nodeId: string,\n  response: YoutubeResponse\n) => {\n  if (response.totalResults) {\n    return updateNode(nodes, nodeId, () => ({\n      titlePostfix:\n        getChildCount(nodes[nodeId]) +\n        (response.nextPageToken ? \" out \" + response.totalResults : \"\"),\n      nextPageToken: response.nextPageToken\n    }));\n  }\n  return nodes;\n};\n\nexport const toggleVisibility = (nodes: Nodes, nodeId: string) =>\n  updateNode(nodes, nodeId, node => ({\n    isHidden: !node.isHidden\n  }));\n\nexport const onDrop = (nodes: Nodes, placement: Placement): Nodes => {\n  if (placement.itemBeingDragged === placement.id) return nodes;\n  if (isDraggingFromDifferentScopes(nodes, placement)) {\n    const newId = createId();\n    const newPlacement = {\n      ...placement,\n      itemBeingDragged: newId\n    };\n    return insertNode(\n      copyNodeDeep(nodes, placement.itemBeingDragged, newId),\n      newPlacement\n    );\n  }\n  return insertNode(deleteNode(nodes, placement.itemBeingDragged), placement);\n};\n\nconst insertNode = (nodes: Nodes, placement: Placement): Nodes => {\n  if (placement.dragLevel !== 0) {\n    const nodeLevel = getNodeLevel(nodes, placement.id);\n    if (placement.dragLevel > nodeLevel) {\n      return updateNode(nodes, placement.id, node => ({\n        children: [placement.itemBeingDragged].concat(node.children || [])\n      }));\n    }\n  }\n\n  const parent = validateParent(\n    getParentKey(nodes, placement.id),\n    placement.id\n  );\n  return updateNode(nodes, parent, node => ({\n    children: insertDragItemAtPlacement(node.children as string[], placement)\n  }));\n};\n\nconst isDraggingFromDifferentScopes = (nodes: Nodes, placement: Placement) =>\n  getRootKey(nodes, placement.id) !==\n  getRootKey(nodes, placement.itemBeingDragged);\n\nexport function insertDragItemAtPlacement(\n  context: string[],\n  action: Placement\n): string[] {\n  let index = context.indexOf(action.id);\n  const targetIndex = action.orientation === \"AFTER\" ? index + 1 : index;\n  const copy = [...context];\n  copy.splice(targetIndex, 0, action.itemBeingDragged);\n  return copy;\n}\n\nconst getChildCount = (node: Node) =>\n  node.children ? node.children.length : 0;\n","import React, { Fragment } from \"react\";\nimport { DragDropContext, DragSource, DropTarget } from \"react-dnd\";\nimport HTML5Backend from \"react-dnd-html5-backend\";\nimport { Placement, PlacementOrientation } from \"./types\";\nimport { getBoundingClientRect, getClientOffset } from \"./offsetHandler\";\nimport {ARROW_SIZE, LEVEL_SHIFT} from \"./components\";\nimport { NodeProps } from \"./Node\";\nimport {getParentKey,} from \"./treeOperations\";\nimport {validateParent} from \"./treeValidation\";\nimport {onDrop} from \"./treeActions\";\n\nconst Context = ({ children }: { children: JSX.Element }) => (\n  <Fragment>{children}</Fragment>\n);\n\nexport const DragContext = DragDropContext(HTML5Backend)(Context);\n\nexport const TreeDragSource = DragSource(\n  \"NODE\",\n  {\n    beginDrag: (props: NodeProps) => {\n      return {\n        id: props.node.id\n      };\n    },\n    endDrag: (props: NodeProps, monitor: any) => {\n      const didDrop = monitor.didDrop();\n      if (!didDrop) {\n        props.setPlacement({\n          id: \"\"\n        });\n      }\n    }\n  },\n  connect => ({\n    connectDragSource: connect.dragSource()\n  })\n);\n\nfunction getVerticalPlacement(\n  rect: DOMRectReadOnly,\n  yPosition: number\n): PlacementOrientation {\n  const middlePoint = (rect.bottom + rect.top) / 2;\n  return middlePoint >= yPosition ? \"BEFORE\" : \"AFTER\";\n}\n\nexport const TreeDropTarget = DropTarget(\n  \"NODE\",\n  {\n    drop(props: NodeProps) {\n      props.setNodes(onDrop(props.nodes, props.placement));\n      props.setPlacement({\n        id: \"\"\n      });\n    },\n    hover(props: NodeProps, monitor: any, component: any) {\n      if (!component) {\n        return null;\n      }\n      const node = component.getNode();\n      if (!node) {\n        return null;\n      }\n\n      const hoverBoundingRect = getBoundingClientRect(node);\n      const clientOffset = getClientOffset(monitor);\n\n      const placement = getVerticalPlacement(hoverBoundingRect, clientOffset.y);\n\n      const offsetWithoutArrow = Math.max(\n        clientOffset.x - ARROW_SIZE - hoverBoundingRect.x,\n        0\n      );\n\n      const dragLevel = Math.floor(offsetWithoutArrow / LEVEL_SHIFT);\n\n      const parent = validateParent(getParentKey(props.nodes, props.node.id), props.node.id);\n      const context = props.nodes[parent].children || [];\n      const isFirst = context.indexOf(props.node.id) === 0;\n\n      const maxDragLevel =\n        placement === \"BEFORE\" && isFirst ? props.level : props.level + 1;\n\n      const desiredDragLevel =\n        dragLevel > maxDragLevel ? maxDragLevel : dragLevel;\n\n      const desiredPlacement: Placement = {\n        itemBeingDragged: monitor.getItem().id,\n        id: props.node.id,\n        orientation: placement,\n        dragLevel: desiredDragLevel\n      };\n      props.setPlacement(desiredPlacement);\n    }\n  },\n  connect => ({\n    connectDropTarget: connect.dropTarget()\n  })\n);\n","//used to stub dependencies over the sizes of the dom elements\n\nexport const getClientOffset = (monitor: any) => monitor.getClientOffset();\n\nexport const getBoundingClientRect = (node: any) =>\n  node.getBoundingClientRect();\n","import React, { useState } from \"react\";\nimport Youtube from \"react-youtube\";\n\ninterface Props {\n  videoId?: string;\n  onEnd: () => void;\n}\n\nconst Player = ({ videoId, onEnd }: Props) => {\n  const [player, setPlayer] = useState();\n\n  if (!videoId) return null;\n\n  return <YoutubePlayerWrapper onReady={setPlayer} videoId={videoId} onEnd={onEnd} />;\n};\n\nconst YoutubePlayerWrapper = (props: any) => (\n  <div style={style}>\n    <Youtube\n      {...props}\n      onReady={e => props.onReady(e.target)}\n      onEnd={props.onEnd}\n      data-testid=\"player\"\n      opts={{\n        height: \"150\",\n        width: \"400\",\n        playerVars: {\n          // https://developers.google.com/youtube/player_parameters\n          autoplay: 1\n        }\n      }}\n    />\n  </div>\n);\n\nconst style = {\n  position: \"fixed\",\n  right: 15,\n  bottom: 15\n} as {};\n\nexport default Player;\n","import { Node, Nodes, NodeType } from \"./types\";\nimport React, { KeyboardEvent, useState, Fragment } from \"react\";\nimport { NodeIcons, NodeText } from \"./components\";\nimport { onDeleteNode, onRenameNode } from \"./treeActions\";\n\ninterface Props {\n  node: Node;\n  nodes: Nodes;\n  setNodes: (nodes: Nodes) => void;\n}\n\nconst NodeTitle = ({ nodes, node, setNodes }: Props) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [text, setText] = useState();\n\n  const onEdit = () => {\n    setText(node.text);\n    setIsEditing(true);\n  };\n\n  const onKey = (e: KeyboardEvent) => {\n    if (e.key === \"Enter\") {\n      endEdit();\n    }\n  };\n\n  const endEdit = () => {\n    setNodes(onRenameNode(nodes, node.id, text));\n    setIsEditing(false);\n  };\n\n  const showType = (nodeType: NodeType) =>\n    nodeType === \"Channel\" || nodeType === \"Playlist\";\n\n  const onDelete = (nodeId: string) => setNodes(onDeleteNode(nodes, nodeId));\n\n  return (\n    <Fragment>\n      {isEditing ? (\n        <input\n          data-testid={\"input-\" + node.id}\n          onBlur={endEdit}\n          autoFocus\n          onKeyPress={onKey}\n          type=\"text\"\n          value={text}\n          onChange={e => setText(e.target.value)}\n        />\n      ) : (\n        <div>\n          {showType(node.type) && (\n            <div style={{ fontSize: 11, color: \"grey\" }}>{node.type}</div>\n          )}\n          <NodeText data-testid={\"title-\" + node.id}>{node.text}</NodeText>\n          {node.isLoading && (\n            <span data-testid={\"loading-\" + node.id}>Loading...</span>\n          )}\n          {node.titlePostfix && (\n            <span style={{ fontSize: 11, color: \"grey\" }}>\n              {\" \"}\n              {node.titlePostfix}\n            </span>\n          )}\n        </div>\n      )}\n      <NodeIcons\n        nodeId={node.id}\n        onEdit={onEdit}\n        onDelete={() => onDelete(node.id)}\n      />\n    </Fragment>\n  );\n};\n\nexport default NodeTitle;\n","import React, { Ref, useImperativeHandle, useRef } from \"react\";\nimport { Node, Nodes, Placement } from \"./types\";\nimport {\n  Arrow,\n  Border,\n  Bullet, LEVEL_SHIFT,\n  NodeContainer,\n  VideoPreview\n} from \"./components\";\nimport { TreeDragSource, TreeDropTarget } from \"./dnd\";\nimport NodeTitle from \"./NodeTitle\";\nimport { TreeProps } from \"./Tree\";\nimport {loadMoreItems, onToggleCollapse} from \"./treeActions\";\n\nexport interface NodeProps extends TreeProps {\n  children: JSX.Element;\n  level: number;\n  node: Node;\n  setNodes: (nodes: Nodes) => void;\n  placement: Placement;\n  setPlacement: (placement: Partial<Placement>) => void;\n  onPlay: (nodeId: Node) => void;\n  connectDragSource: any;\n  connectDropTarget: any;\n}\n\nconst NodeElement = React.forwardRef(\n  (\n    {\n      children,\n      node,\n      level,\n      connectDragSource,\n      connectDropTarget,\n      placement,\n      onPlay,\n      setNodes,\n      nodes\n    }: NodeProps,\n    ref: Ref<HTMLDivElement>\n  ) => {\n    const elementRef = useRef<HTMLDivElement>(null);\n\n    // @ts-ignore\n    useImperativeHandle(ref, () => {\n      connectDropTarget(elementRef);\n      return {\n        getNode: () => elementRef.current\n      };\n    });\n\n    return (\n      <div>\n        <NodeContainer\n          data-testid={\"node-\" + node.id}\n          level={level}\n          ref={elementRef}\n        >\n          <Arrow\n            orientation={node.isHidden ? \"right\" : \"down\"}\n            nodeId={node.id}\n            onClick={() => onToggleCollapse(nodes, setNodes, node.id)}\n          />\n          {node.type !== \"Composite\" ? (\n            <VideoPreview\n              type={node.type}\n              alt=\"Cover image\"\n              onClick={() => onPlay(node)}\n              ref={connectDragSource}\n              src={node.imageUrl}\n              data-testid={`video-image-${node.id}`}\n            />\n          ) : (\n            <Bullet node={node} ref={connectDragSource} />\n          )}\n          <NodeTitle setNodes={setNodes} nodes={nodes} node={node} />\n          {node.id === placement.id && (\n            <Border\n              placement={placement}\n              level={level}\n              data-testid={\"border-\" + node.id}\n            />\n          )}\n        </NodeContainer>\n        {children}\n        {(node.nextPageToken && !node.isHidden) && <button style={{marginLeft: level * LEVEL_SHIFT}} onClick={() => loadMoreItems(nodes, node.id, setNodes)}>more</button>}\n      </div>\n    );\n  }\n);\n\nexport default TreeDropTarget(TreeDragSource(NodeElement));\n","import React, { Fragment } from \"react\";\nimport { Node, Nodes, Placement } from \"./types\";\nimport NodeElement from \"./Node\";\nimport {getParentKey} from \"./treeOperations\";\n\nexport interface TreeProps {\n  ids: string[];\n  level: number;\n  nodes: Nodes;\n  setNodes: (nodes: Nodes) => void;\n  placement: Partial<Placement>;\n  setPlacement: (placement: Partial<Placement>) => void;\n  onPlay: (node: Node) => void;\n}\n\nconst Tree = (props: TreeProps) => {\n  const { nodes, ids, level } = props;\n  validateChildren(nodes, ids);\n  return (\n    <Fragment>\n      {ids.map(id => (\n        <NodeElement {...props} key={id} node={nodes[id]} level={level}>\n          {hasChildren(nodes[id]) && (\n            <Tree\n              {...props}\n              ids={nodes[id].children as string[]}\n              level={level + 1}\n            />\n          )}\n        </NodeElement>\n      ))}\n    </Fragment>\n  );\n};\n\n//check that all node children can be found in the Nodes tree\nconst validateChildren = (nodes: Nodes, children: string[]) => {\n  children.forEach(node => {\n    if (!nodes[node]) {\n      const parent = getParentKey(nodes, node);\n      throw new Error(\n        `Node '${parent}' contains a non-existing child '${node}'. Check children of '${parent}'`\n      );\n    }\n  });\n};\n\nconst hasChildren = (node: Node) => node.children && !node.isHidden;\n\nexport default Tree;\n","import React, { Fragment, useEffect, useState } from \"react\";\nimport { DragContext } from \"./tree/dnd\";\nimport { sampleNodes } from \"./tree/sampleTrees\";\nimport { Node, Nodes, Placement, Roots } from \"./tree/types\";\nimport Player from \"./player\";\nimport { searchVideos, YoutubeResponse } from \"./youtube/api\";\nimport { shallowEqual, useDebounce } from \"./utils\";\nimport { onCreateNode, onSearchDone } from \"./tree/treeActions\";\nimport { mapVideosToNodes } from \"./youtube/mapVideosToNodes\";\nimport Tree from \"./tree/Tree\";\nimport { getNextNodeId } from \"./tree/treeOperations\";\n\ninterface Props {\n  processDefaultNodes?: (nodes: Nodes) => Nodes;\n}\n\nconst STORAGE_KEY = \"nodes:v0.1\";\n\nconst App: React.FC<Props> = ({ processDefaultNodes }) => {\n  const [nodes, setNodes] = useState(\n    processDefaultNodes ? processDefaultNodes(sampleNodes) : sampleNodes\n  );\n  const updateNodes = (nodes: Nodes) => {\n    setNodes(nodes);\n    window.localStorage.setItem(STORAGE_KEY, JSON.stringify(nodes));\n  };\n\n  useEffect(() => {\n    const res = window.localStorage.getItem(STORAGE_KEY);\n    if (res) {\n      setNodes(JSON.parse(res));\n    }\n  }, []);\n\n  const [placement, setPlacement] = useState({} as Partial<Placement>);\n\n  const [nodeBeingPlayed, setNodeBeingPlayer] = useState({} as Node);\n\n  const onPlay = (node: Node) => setNodeBeingPlayer(node);\n\n  const setSearchNodes = (response: YoutubeResponse, override?: boolean) => {\n    //TORO: remove this anti-pattern, do not set true flags for single method\n    updateNodes(\n      onSearchDone(\n        nodes,\n        Roots.SEARCH,\n        mapVideosToNodes(response),\n        response,\n        override\n      )\n    );\n  };\n\n  const updatePlacementOptimized = (newPlacement: Partial<Placement>) => {\n    if (!shallowEqual(newPlacement, placement)) {\n      console.count(\"called set placement\");\n      setPlacement(newPlacement);\n    }\n  };\n\n  const addNewNodeForFavorites = () =>\n    updateNodes(onCreateNode(nodes, Roots.FAVORITES));\n\n  const resetState = () => {\n    setNodes(sampleNodes);\n    window.localStorage.removeItem(STORAGE_KEY);\n  };\n\n  const playNextTrack = () => {\n    const next = getNextNodeId(nodes, nodeBeingPlayed.id);\n    if(next) {\n      setNodeBeingPlayer(nodes[next]);\n    }\n  };\n\n  return (\n    <div>\n      <DragContext>\n        <LayoutManager\n          searchNode={nodes[Roots.SEARCH]}\n          onSearchDone={setSearchNodes}\n          renderRight={() => (\n            <Fragment>\n              <Tree\n                nodes={nodes}\n                ids={nodes[Roots.FAVORITES].children as string[]}\n                level={0}\n                setPlacement={updatePlacementOptimized}\n                setNodes={updateNodes}\n                onPlay={onPlay}\n                placement={placement}\n              />\n              <button\n                data-testid=\"add-new-node\"\n                onClick={addNewNodeForFavorites}\n              >\n                add\n              </button>\n            </Fragment>\n          )}\n          renderLeft={() => (\n            <Tree\n              nodes={nodes}\n              ids={nodes[Roots.SEARCH].children as string[]}\n              level={0}\n              onPlay={onPlay}\n              setPlacement={updatePlacementOptimized}\n              setNodes={updateNodes}\n              placement={placement}\n            />\n          )}\n        />\n      </DragContext>\n      <Player videoId={nodeBeingPlayed.videoUrl} onEnd={playNextTrack} />\n      <button\n        style={{ position: \"absolute\", top: 5, right: 5 }}\n        onClick={resetState}\n      >\n        Reset\n      </button>\n    </div>\n  );\n};\n\nconst LayoutManager = ({\n  renderRight,\n  renderLeft,\n  onSearchDone,\n  searchNode\n}: any) => {\n  const [seachVisible, setSearchVisibility] = useState(false);\n  const style = seachVisible\n    ? { flex: 1 }\n    : { width: 40, backgroundColor: \"lightGrey\" };\n  return (\n    <div\n      style={{\n        flexDirection: \"row\",\n        display: \"flex\",\n        alignItems: \"stretch\",\n        height: \"100vh\"\n      }}\n    >\n      <div style={style} data-testid=\"search-zone\">\n        <Search\n          searchNode={searchNode}\n          isVisible={seachVisible}\n          onSearchDone={onSearchDone}\n          onClick={() => setSearchVisibility(!seachVisible)}\n          renderTree={renderLeft}\n        />\n      </div>\n\n      <div style={{ flex: 1 }} data-testid=\"favorites-zone\">\n        {renderRight()}\n      </div>\n    </div>\n  );\n};\n\nconst Search = ({\n  searchNode,\n  isVisible,\n  onClick,\n  renderTree,\n  onSearchDone\n}: any) => {\n  const [value, setValue] = useState(\"\");\n  const throttledValue = useDebounce(value, 500);\n  useEffect(() => {\n    if (throttledValue) {\n      searchVideos(throttledValue).then(res =>\n        onSearchDone(res, true)\n      );\n    }\n  }, [throttledValue]);\n\n  const loadMoreSearch = () => {\n    searchVideos(throttledValue, searchNode.nextPageToken).then(onSearchDone);\n  };\n  return (\n    <div>\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: isVisible ? \"flex-end\" : \"center\",\n          paddingRight: isVisible ? 20 : 0\n        }}\n      >\n        <button data-testid=\"toggle-sidebar\" onClick={onClick}>\n          {isVisible ? \"<\" : \"+\"}\n        </button>\n      </div>\n      {isVisible && (\n        <Fragment>\n          <input\n            data-testid=\"search-input\"\n            type=\"text\"\n            value={value}\n            onChange={e => setValue(e.target.value)}\n          />{\" \"}\n          {searchNode.titlePostfix && (\n            <span style={{ fontSize: 11, color: \"grey\" }}>\n              {\" \"}\n              {searchNode.titlePostfix}\n            </span>\n          )}\n        </Fragment>\n      )}\n      {isVisible && renderTree()}\n      {isVisible && <button onClick={loadMoreSearch}>more</button>}\n    </div>\n  );\n};\n\nexport default App;\n","import { useEffect, useState } from \"react\";\n\nexport function useDebounce(value: any, delay: number) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    // Cancel the timeout if value changes (also on delay change or unmount)\n    // This is how we prevent debounced value from updating if value is changed ...\n    // .. within the delay period. Timeout gets cleared and restarted.\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","export function shallowEqual(objA: any, objB: any) {\n  if (objA === objB) {\n    return true;\n  }\n\n  if (!objA || !objB) {\n    return false;\n  }\n\n  var aKeys = Object.keys(objA);\n  var bKeys = Object.keys(objB);\n  var len = aKeys.length;\n\n  if (bKeys.length !== len) {\n    return false;\n  }\n\n  for (var i = 0; i < len; i++) {\n    var key = aKeys[i];\n\n    if (objA[key] !== objB[key]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/folder-closed-withItems.64114435.svg\";","module.exports = __webpack_public_path__ + \"static/media/folder-closed-loader.d552820a.svg\";","module.exports = __webpack_public_path__ + \"static/media/folder-closed-empty.5f8d5aa0.svg\";","module.exports = __webpack_public_path__ + \"static/media/folder-opened-many.f8af0c07.svg\";","module.exports = __webpack_public_path__ + \"static/media/folder-opened-single.cfca5246.svg\";","module.exports = __webpack_public_path__ + \"static/media/folder-opened-empty.feffd839.svg\";"],"sourceRoot":""}