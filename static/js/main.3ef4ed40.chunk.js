(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{134:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(16),o=n.n(a),c=(n(68),n(7)),u=n(18),d=n(49),l=n.n(d),s=n(3),f=n(4);function p(){var e=Object(s.a)(["\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-top: 2px;\n  padding-bottom: 2px;\n  padding-left: ","px;\n"]);return p=function(){return e},e}var m=f.a.div(p(),function(e){return 20*e.level});function h(){var e=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return h=function(){return e},e}var v=f.a.div(h());function g(){var e=Object(s.a)(["\n  height: ","px;\n  width: ","px;\n  min-width: ","px;\n"]);return g=function(){return e},e}function b(){var e=Object(s.a)(["\n  width: 0;\n  height: 0;\n  border-style: solid;\n  ",";\n  visibility: hidden;\n  ",":hover & {\n    visibility: visible;\n  }\n"]);return b=function(){return e},e}var y=function(e){return i.a.createElement(E,{onClick:e.onClick},i.a.createElement(O,{"data-testid":"arrow-"+e.nodeId,orientation:e.orientation}))},O=f.a.div(b(),function(e){return j(e.orientation)},m),E=Object(f.a)(v)(g(),15,15,15),j=function(e){var t=6.9282.toFixed(1);return"right"===e?"\n    border-width: ".concat(4,"px 0 ").concat(4,"px ").concat(t,"px;\n    border-color: transparent transparent transparent ").concat("rgb(75, 81, 85)",";\n  "):"  \n    border-width: ".concat(t,"px ").concat(4,"px 0 ").concat(4,"px;\n    border-color: ").concat("rgb(75, 81, 85)"," transparent transparent transparent;\n    ")};function x(){var e=Object(s.a)(["\n  height: 2px;\n  background-color: grey;\n  position: absolute;\n  left: ","px;\n  right: 0;\n  ",";\n"]);return x=function(){return e},e}var w=f.a.div(x(),function(e){return 15+20*e.placement.dragLevel},function(e){return"AFTER"===e.placement.orientation?"bottom: -1px":"top: -1px"}),I=n(52),C=n.n(I),S=n(53),k=n.n(S),R=n(54),D=n.n(R),P=n(55),A=n.n(P),B=n(56),L=n.n(B),T=n(57),F=n.n(T);function N(){var e=Object(s.a)(["\n  margin-right: 5px;\n"]);return N=function(){return e},e}function U(){var e=Object(s.a)(["\n  filter: invert(0.3);\n  ",":hover & {\n    filter: invert(0);\n  }\n"]);return U=function(){return e},e}var V=i.a.forwardRef(function(e,t){var n=e.node;return i.a.createElement(z,{ref:t,"data-testid":"drag-handle-"+n.id},i.a.createElement(M,{src:H(n),alt:"",width:25,height:25}))}),H=function(e){if(e.isHidden)return e.children&&e.children.length>0?C.a:e.loader?k.a:D.a;var t=e.children;return t?t.length>1?A.a:L.a:F.a},M=f.a.img(U(),m),z=f.a.div(N());function G(){var e=Object(s.a)([""]);return G=function(){return e},e}var J=f.a.span(G());function K(){var e=Object(s.a)(["\n  visibility: hidden;\n  ",":hover & {\n    visibility: visible;\n  }\n  padding-left: 10px;\n"]);return K=function(){return e},e}var W=function(e){var t=e.onEdit,n=e.onDelete,r=e.nodeId;return i.a.createElement(X,null,i.a.createElement("button",{"data-testid":"edit-"+r,onClick:t},"E"),i.a.createElement("button",{"data-testid":"delete-"+r,onClick:n},"X"))},X=f.a.div(K(),m);function q(){var e=Object(s.a)(["\n  height: 32px;\n  width: 32px;\n\n  max-width: 100%;\n\n  border-radius: ","px;\n\n  ",";\n  margin-right: 5px;\n"]);return q=function(){return e},e}var Q=f.a.img(q(),function(e){return Y(e.type)?60:3},function(e){return Y(e.type)?"":"height: auto"}),Y=function(e){return"Channel"===e||"Playlist"===e},Z=n(6),$=n(1),_=function(){return Math.random()+""};var ee=function(e,t){if(!e)throw new Error("Expected parent for node "+t+", but not "+e);return e},te=function(e,t,n){return Object($.a)({},e,Object(Z.a)({},t,Object($.a)({},e[t],n(e[t]))))},ne=function(e,t){var n=ee(ie(e,t),t);return te(e,n,function(e){return{children:(n=e.children,r=t,n?n.filter(function(e){return e!==r}):[])};var n,r})},re=function(e,t){return function(e){if(!e||0===e.length)throw new Error("Expected a non-empty array "+e);return e[0]}(ae(e,t))},ie=function(e,t){return Object.keys(e).find(function(n){return r=e[n].children,i=t,!!r&&r.indexOf(i)>=0;var r,i})},ae=function(e,t){for(var n=[t],r=ie(e,t);r;)n=[r].concat(n),r=ie(e,r);return n},oe=n(61),ce=function(e,t){return te(e,t,function(){return{isLoading:!0}})},ue=function(e,t,n){var r=n.map(function(e){return e.id}),i=n.reduce(function(e,t){return function(e,t){return Object($.a)({},e,Object(Z.a)({},t.id,t))}(e,t)},e);return te(i,t,function(){return{children:r,isLoading:!1,isHidden:!1}})},de=function(e,t){return te(e,t,function(e){return{isHidden:!e.isHidden}})},le=function(e,t){if(t.itemBeingDragged===t.id)return e;if(fe(e,t)){var n=_(),r=Object($.a)({},t,{itemBeingDragged:n});return se(function e(t,n,r){var i,a=t[n].children;if(a){var o=a.map(function(){return _()});i=o.reduce(function(t,n,r){return e(t,a[r],n)},t),i=te(i,r,function(e){return Object($.a)({},e,{children:o})})}else i=t;return Object($.a)({},i,Object(Z.a)({},r,Object($.a)({},i[n],{children:i[r]?i[r].children:void 0,id:r})))}(e,t.itemBeingDragged,n),r)}return se(ne(e,t.itemBeingDragged),t)},se=function(e,t){if(0!==t.dragLevel){var n=function(e,t){return ae(e,t).length-2}(e,t.id);if(t.dragLevel>n)return te(e,t.id,function(e){return{children:[t.itemBeingDragged].concat(e.children||[])}})}var r=ee(ie(e,t.id),t.id);return te(e,r,function(e){return{children:pe(e.children,t)}})},fe=function(e,t){return re(e,t.id)!==re(e,t.itemBeingDragged)};function pe(e,t){var n=e.indexOf(t.id),r="AFTER"===t.orientation?n+1:n,i=Object(oe.a)(e);return i.splice(r,0,t.itemBeingDragged),i}var me=Object(u.DragDropContext)(l.a)(function(e){var t=e.children;return i.a.createElement(r.Fragment,null,t)}),he=Object(u.DragSource)("NODE",{beginDrag:function(e){return{id:e.node.id}},endDrag:function(e,t){t.didDrop()||e.setPlacement({id:""})}},function(e){return{connectDragSource:e.dragSource()}});var ve,ge=Object(u.DropTarget)("NODE",{drop:function(e){e.setNodes(le(e.nodes,e.placement)),e.setPlacement({id:""})},hover:function(e,t,n){if(!n)return null;var r=n.getNode();if(!r)return null;var i,a,o=function(e){return e.getBoundingClientRect()}(r),c=function(e){return e.getClientOffset()}(t),u=(i=o,a=c.y,(i.bottom+i.top)/2>=a?"BEFORE":"AFTER"),d=Math.max(c.x-15-o.x,0),l=Math.floor(d/20),s=ee(ie(e.nodes,e.node.id),e.node.id),f=0===(e.nodes[s].children||[]).indexOf(e.node.id),p="BEFORE"===u&&f?e.level:e.level+1,m=l>p?p:l,h={itemBeingDragged:t.getItem().id,id:e.node.id,orientation:u,dragLevel:m};e.setPlacement(h)}},function(e){return{connectDropTarget:e.dropTarget()}});!function(e){e.FAVORITES="ROOT.favorites",e.SEARCH="ROOT.search"}(ve||(ve={}));var be,ye,Oe=Object($.a)({},Ee("1",["1.1","1.2"]),Ee("1.1"),Ee("1.2",["1.2.1"]),Ee("1.2.1"),Ee("2",["2.1"]),Ee("2.1",["2.1.1"]),Ee("2.1.1"),(be="Loading Google Playlists",ye={channelId:"UC_x5XG1OV2P6uZZ5FSM9Ttw"},Object(Z.a)({},be,Object($.a)({},xe(ye.channelId),{id:be}))),Ee("Ambient",["Carbon Based Lifeforms Album 1","Carbon Based Lifeforms Album 2"]),je("Carbon Based Lifeforms Album 1","f5ddAAYasgM","https://picsum.photos/id/190/132/132?grayscale"),je("Carbon Based Lifeforms Album 2","KQE29az48gM","https://picsum.photos/id/191/132/132?grayscale"),function(e,t,n){var r={id:e,text:e,type:"Playlist",imageUrl:n,playlistId:t};return Object(Z.a)({},e,r)}("MyPlaylist","MyPlaylistId","https://picsum.photos/id/192/132/132?grayscale"),we(["1","2","Loading Google Playlists"],ve.FAVORITES),we(["Ambient"],ve.SEARCH));function Ee(e,t){var n={id:e,text:"Node "+e,children:t,type:"Composite"};return Object(Z.a)({},e,n)}function je(e,t,n){var r={id:e,text:e,type:"Video",imageUrl:n,videoUrl:t};return Object(Z.a)({},e,r)}function xe(e){return{id:_(),text:"Playlists",type:"Composite",isHidden:!0,loader:{type:"Playlists",channelId:e}}}function we(e,t){var n={id:t,text:t,children:e,type:"Root"};return Object(Z.a)({},t,n)}var Ie=n(58),Ce=function(e){return i.a.createElement("div",{style:Se},i.a.createElement(Ie.a,Object.assign({},e,{onReady:function(t){return e.onReady(t.target)},"data-testid":"player",opts:{height:"150",width:"220",playerVars:{autoplay:1}}})))},Se={position:"absolute",right:15,bottom:15},ke=function(e){var t=e.videoId,n=Object(r.useState)(),a=Object(c.a)(n,2),o=(a[0],a[1]);return t?i.a.createElement(Ce,{onReady:o,videoId:t}):null},Re="AIzaSyBsCL-zrXWd9S2FKRSDVfz7dOo783LQkLk",De=function(e){return"youtube#video"===e||"youtube#playlist"===e||"youtube#channel"===e},Pe=function(e){return"youtube#video"===e.id.kind?Ae(e):"youtube#playlist"===e.id.kind?Be(e):Le(e)},Ae=function(e){return Object($.a)({},Te(e.snippet),{previewUrl:e.snippet.thumbnails.default.url,videoId:e.id.videoId,type:"Video"})},Be=function(e){return Object($.a)({},Te(e.snippet),{previewUrl:e.snippet.thumbnails.default.url,playlistId:e.id.playlistId,type:"Playlist"})},Le=function(e){return Object($.a)({},Te(e.snippet),{previewUrl:e.snippet.thumbnails.default.url,channelId:e.id.channelId,type:"Channel"})},Te=function(e){var t=e.title;return{title:Fe(t)}},Fe=function(e){return e.replace(/[^\x00-\x7F]/g,"")},Ne=function(e,t){return console.log("Requesting Youtube ".concat(t," for ").concat(e)),e},Ue=function(e){return e.items.map(Ve)},Ve=function(e){return Object($.a)({id:_(),text:e.title},He(e),{imageUrl:e.previewUrl,isHidden:!0})},He=function(e){return{type:Me(e.type),videoUrl:e.videoId,channelId:e.channelId,playlistId:e.playlistId}},Me=function(e){return"Video"===e?"Video":"Playlist"===e?"Playlist":"Channel"},ze=function(e){var t,n=e.nodes,a=e.node,o=e.setNodes,u=Object(r.useState)(!1),d=Object(c.a)(u,2),l=d[0],s=d[1],f=Object(r.useState)(),p=Object(c.a)(f,2),m=p[0],h=p[1],v=function(){o(function(e,t,n){return te(e,t,function(){return{text:n}})}(n,a.id,m)),s(!1)},g=function(e){return o(function(e,t){return ne(e,t)}(n,e))};return i.a.createElement(r.Fragment,null,l?i.a.createElement("input",{"data-testid":"input-"+a.id,onBlur:v,autoFocus:!0,onKeyPress:function(e){"Enter"===e.key&&v()},type:"text",value:m,onChange:function(e){return h(e.target.value)}}):i.a.createElement("div",null,("Channel"===(t=a.type)||"Playlist"===t)&&i.a.createElement("div",{style:{fontSize:11,color:"grey"}},a.type),i.a.createElement(J,{"data-testid":"title-"+a.id},a.text),a.isLoading&&i.a.createElement("span",{"data-testid":"loading-"+a.id},"Loading...")),i.a.createElement(W,{nodeId:a.id,onEdit:function(){h(a.text),s(!0)},onDelete:function(){return g(a.id)}}))},Ge=ge(he(i.a.forwardRef(function(e,t){var n=e.children,a=e.node,o=e.level,c=e.connectDragSource,u=e.connectDropTarget,d=e.placement,l=e.onPlay,s=e.setNodes,f=e.nodes,p=Object(r.useRef)(null);Object(r.useImperativeHandle)(t,function(){return u(p),{getNode:function(){return p.current}}});var h=function(e){var t,n,r=f[e].children;if(r&&r.length>0)s(de(f,e));else if("Video"===f[e].type)s(ce(f,e)),(n=f[e].videoUrl,fetch("https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&key=".concat(Re,"&relatedToVideoId=")+Ne(n,"search similar")).then(function(e){return e.json()}).then(function(e){return{items:e.items.filter(function(e){return e.id.videoId}).map(function(e){return Object($.a)({},Te(e.snippet),{type:"Video",videoId:e.id.videoId,previewUrl:e.snippet.thumbnails.default.url})})}})).then(function(t){s(ue(f,e,Ue(t)))});else if("Playlist"===f[e].type)s(ce(f,e)),(t=f[e].playlistId,Ne(t,"playlistItems"),fetch("https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=".concat(t,"&key=").concat(Re,"&maxResults=20")).then(function(e){return e.json()}).then(function(e){return{items:e.items.map(function(e){return Object($.a)({},Te(e.snippet),{type:"Video",videoId:e.snippet.resourceId.videoId,previewUrl:e.snippet.thumbnails.default.url})})}})).then(function(t){return s(ue(f,e,Ue(t)))});else if("Channel"===f[e].type){var i=f[e].channelId;s(ce(f,e)),function(e){return Ne(e,"videos for channel"),fetch("https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=".concat(e,"&key=").concat(Re,"&maxResults=20&order=date&type=video")).then(function(e){return e.json()}).then(function(e){return{items:e.items.map(Pe)}})}(i).then(function(t){return s(ue(f,e,function(e,t){return[xe(t)].concat(e)}(Ue(t),i)))})}else{var a=f[e].loader;if(a){if("Playlists"!==a.type)throw new Error("Unexpected loader: "+a.type);s(ce(f,e)),function(e){return Ne(e,"playlists for channel"),fetch("https://www.googleapis.com/youtube/v3/playlists?part=snippet%2CcontentDetails&channelId=".concat(e,"&maxResults=25&key=").concat(Re)).then(function(e){return e.json()}).then(function(e){return{items:e.items.map(function(e){return Object($.a)({},Te(e.snippet),{previewUrl:e.snippet.thumbnails.default.url,playlistId:e.id,type:"Playlist"})})}})}(a.channelId).then(function(t){return s(ue(f,e,Ue(t)))})}else s(de(f,e))}};return i.a.createElement("div",null,i.a.createElement(m,{"data-testid":"node-"+a.id,level:o,ref:p},i.a.createElement(y,{orientation:a.isHidden?"right":"down",nodeId:a.id,onClick:function(){return h(a.id)}}),"Composite"!==a.type?i.a.createElement(Q,{type:a.type,alt:"Cover image",onClick:function(){return l(a)},ref:c,src:a.imageUrl,"data-testid":"video-image-".concat(a.id)}):i.a.createElement(V,{node:a,ref:c}),i.a.createElement(ze,{setNodes:s,nodes:f,node:a}),a.id===d.id&&i.a.createElement(w,{placement:d,level:o,"data-testid":"border-"+a.id})),n)}))),Je=function(e,t){t.forEach(function(t){if(!e[t]){var n=ie(e,t);throw new Error("Node '".concat(n,"' contains a non-existing child '").concat(t,"'. Check children of '").concat(n,"'"))}})},Ke=function(e){return e.children&&!e.isHidden},We=function e(t){var n=t.nodes,a=t.ids,o=t.level;return Je(n,a),i.a.createElement(r.Fragment,null,a.map(function(r){return i.a.createElement(Ge,Object.assign({},t,{key:r,node:n[r],level:o}),Ke(n[r])&&i.a.createElement(e,Object.assign({},t,{ids:n[r].children,level:o+1})))}))},Xe=function(e){var t=e.renderRight,n=e.renderLeft,a=e.onSearchDone,o=Object(r.useState)(!1),u=Object(c.a)(o,2),d=u[0],l=u[1],s=d?{flex:1}:{width:40,backgroundColor:"lightGrey"};return i.a.createElement("div",{style:{flexDirection:"row",display:"flex",alignItems:"stretch",height:"100vh"}},i.a.createElement("div",{style:s,"data-testid":"search-zone"},i.a.createElement(qe,{isVisible:d,onSearchDone:a,onClick:function(){return l(!d)},renderTree:n})),i.a.createElement("div",{style:{flex:1},"data-testid":"favorites-zone"},t()))},qe=function(e){var t=e.isVisible,n=e.onClick,a=e.renderTree,o=e.onSearchDone,u=Object(r.useState)(""),d=Object(c.a)(u,2),l=d[0],s=d[1],f=function(e,t){var n=Object(r.useState)(e),i=Object(c.a)(n,2),a=i[0],o=i[1];return Object(r.useEffect)(function(){var n=setTimeout(function(){o(e)},t);return function(){clearTimeout(n)}},[e,t]),a}(l,500);return Object(r.useEffect)(function(){var e;f&&(e=f,fetch("https://www.googleapis.com/youtube/v3/search?part=snippet&shart=mostPopular&maxResults=10&key=".concat(Re,"&q=")+Ne(e,"search")).then(function(e){return e.json()}).then(function(e){return{items:e.items.filter(function(e){return De(e.id.kind)}).map(Pe)}})).then(o)},[f]),i.a.createElement("div",null,i.a.createElement("div",{style:{display:"flex",justifyContent:t?"flex-end":"center",paddingRight:t?20:0}},i.a.createElement("button",{"data-testid":"toggle-sidebar",onClick:n},t?"<":"+")),t&&i.a.createElement("input",{"data-testid":"search-input",type:"text",value:l,onChange:function(e){return s(e.target.value)}}),t&&a())},Qe=function(e){var t=e.processDefaultNodes,n=Object(r.useState)(t?t(Oe):Oe),a=Object(c.a)(n,2),o=a[0],u=a[1],d=function(e){u(e),window.localStorage.setItem("nodes:v0.1",JSON.stringify(e))};Object(r.useEffect)(function(){var e=window.localStorage.getItem("nodes:v0.1");e&&u(JSON.parse(e))},[]);var l=Object(r.useState)({}),s=Object(c.a)(l,2),f=s[0],p=s[1],m=Object(r.useState)({}),h=Object(c.a)(m,2),v=h[0],g=h[1],b=function(e){return g(e)},y=function(e){(function(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),r=Object.keys(t),i=n.length;if(r.length!==i)return!1;for(var a=0;a<i;a++){var o=n[a];if(e[o]!==t[o])return!1}return!0})(e,f)||(console.count("called set placement"),p(e))},O=function(){return d(function(e,t){var n=Math.random()+"",r={text:"New Node",type:"Composite",id:n},i=te(e,t,function(e){return{children:e.children.concat([n])}});return Object($.a)({},i,Object(Z.a)({},n,r))}(o,ve.FAVORITES))};return i.a.createElement("div",null,i.a.createElement(me,null,i.a.createElement(Xe,{onSearchDone:function(e){d(ue(o,ve.SEARCH,Ue(e)))},renderRight:function(){return i.a.createElement(r.Fragment,null,i.a.createElement(We,{nodes:o,ids:o[ve.FAVORITES].children,level:0,setPlacement:y,setNodes:d,onPlay:b,placement:f}),i.a.createElement("button",{"data-testid":"add-new-node",onClick:O},"add"))},renderLeft:function(){return i.a.createElement(We,{nodes:o,ids:o[ve.SEARCH].children,level:0,onPlay:b,setPlacement:y,setNodes:d,placement:f})}})),i.a.createElement(ke,{videoId:v.videoUrl}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Qe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},52:function(e,t,n){e.exports=n.p+"static/media/folder-closed-withItems.64114435.svg"},53:function(e,t,n){e.exports=n.p+"static/media/folder-closed-loader.d552820a.svg"},54:function(e,t,n){e.exports=n.p+"static/media/folder-closed-empty.5f8d5aa0.svg"},55:function(e,t,n){e.exports=n.p+"static/media/folder-opened-many.f8af0c07.svg"},56:function(e,t,n){e.exports=n.p+"static/media/folder-opened-single.cfca5246.svg"},57:function(e,t,n){e.exports=n.p+"static/media/folder-opened-empty.feffd839.svg"},63:function(e,t,n){e.exports=n(134)},68:function(e,t,n){}},[[63,1,2]]]);
//# sourceMappingURL=main.3ef4ed40.chunk.js.map